sudo: require
branches:
  only:
    - master
dist: xenial
language:
  - cpp

matrix:
  include:
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-7
            - g++-7
            - libboost-all-dev
            - libopenimageio-dev
            - openmpi-bin
            - libopenmpi-dev
            - libhdf5-openmpi-dev
            - libdcmtk-dev
            - petsc-dev
      env:
        - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"

    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-8
            - g++-8
            - libboost-all-dev
            - libopenimageio-dev
            - mpich
            - libmpich-dev
            - libhdf5-openmpi-dev
            - libdcmtk-dev
            - libpetsc3.6.2-dev
      env:
        - MATRIX_EVAL="CC=gcc-8 && CXX=g++-8"


before_install:
  - eval "${MATRIX_EVAL}"

script:
  - mkdir build
  -  cd build
  - cmake -DPETSC_EXECUTABLE_RUNS:BOOL=Yes ..
  - make
